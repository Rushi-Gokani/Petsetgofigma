<div>
  <div
    class="fixed start-0 z-20 w-full rounded-t-md bg-bg-500 px-5 md:sticky md:w-[--account-width] md:border-b-1 md:border-transparent md:bg-transparent md:px-2 md:pt-0 md:transition-all md:delay-150 md:duration-300 max-md:top-0 max-md:pb-3 max-md:pt-[18px]"
    :class="
      {
        'md:bg-bg-500 md:border-bg-600': $store.resizable.isVisible('account-desktop'),
        'md:bg-transparent md:border-transparent': !$store.resizable.isVisible('account-desktop'),
        'md:max-w-24': !$store.resizable.isVisible('account-desktop'),
        'md:min-w-[320px]': $store.resizable.isVisible('account-desktop')
      }
    "
  >
    <div class="relative isolate flex w-full md:min-h-[56px] md:items-center">
      <button
        type="button"
        class="absolute h-0 w-0 overflow-hidden p-0 m-0"
        tabindex="-1"
        aria-hidden="true"
        x-a11y-trap-target.initial="$store.resizable.isVisible('account-desktop')"
      ></button>
      
      <div class="flex items-center gap-3 w-full">
        {% if customer %}
          <div class="account-initials-popup">
            {{ customer.first_name | slice: 0 | upcase }}{{ customer.last_name | slice: 0 | upcase }}
          </div>
          <div class="flex flex-col" :class="{ 'md:hidden': !$store.resizable.isVisible('account-desktop') }">
            <span class="font-semibold text-text-700">{{ customer.first_name }} {{ customer.last_name }}</span>
            <span class="text-sm text-text-500">{{ customer.email }}</span>
          </div>
        {% else %}
          <div class="flex h-10 w-10 items-center justify-center rounded-full bg-primary-100 text-primary-500">
            {% render 'icon-account' %}
          </div>
          <div class="flex flex-col" :class="{ 'md:hidden': !$store.resizable.isVisible('account-desktop') }">
            <span class="font-semibold text-text-700">{{ 'customer.account_fallback' | t }}</span>
          </div>
        {% endif %}
      </div>
    </div>
  </div>
  
  <div
    x-show="$store.resizable.isVisible('account-desktop')"
    class="flex flex-col gap-3 overflow-x-hidden pt-2 transition-opacity duration-0 md:inset-x-0 md:top-full md:max-h-[calc(100dvh-125px)] md:rounded-t-none md:pt-0 md:duration-300 md:before:rounded-none"
    x-transition:enter="md:delay-450"
    x-transition:enter-start="md:opacity-0"
    x-transition:enter-end="md:opacity-100"
    x-transition:leave="md:duration-0"
    x-transition:leave-start="md:opacity-100"
    x-transition:leave-end="md:opacity-0"
  >
    <div class="relative flex grow flex-col gap-4 p-3 pb-2 md:p-5">
      {% if customer %}
        <div class="flex flex-col gap-3">
          <h2 class="text-lg font-semibold">{{ 'customer.account.title' | t }}</h2>
          
          <div class="flex flex-col gap-2">
            <a 
              href="{{ routes.account_url }}" 
              class="button button--outline-secondary w-full justify-start"
              x-element-transition-trigger
            >
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 344 384"><path fill="currentColor" d="M170.5 192q-35.5 0-60.5-25t-25-60.5T110 46t60.5-25T231 46t25 60.5t-25 60.5t-60.5 25zm0 43q31.5 0 69.5 9t69.5 29.5T341 320v43H0v-43q0-26 31.5-46.5T101 244t69.5-9z"/></svg>
              {{ 'customer.account.view_account' | t }}
            </a>
            
            <a 
              href="{{ routes.account_addresses_url }}" 
              class="button button--outline-secondary w-full justify-start"
              x-element-transition-trigger
            >
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 42 42"><path fill="currentColor" fill-rule="evenodd" d="M33 13.924C33 6.893 27.594 1 20.51 1S8 6.897 8 13.93C8 16.25 8.324 18 9.423 20h-.021l10.695 20.621c.402.551.824-.032.824-.032C20.56 41.13 31.616 20 31.616 20h-.009C32.695 18 33 16.246 33 13.924zm-18.249-.396c0-3.317 2.579-6.004 5.759-6.004c3.179 0 5.76 2.687 5.76 6.004s-2.581 6.005-5.76 6.005c-3.18 0-5.759-2.687-5.759-6.005z"/></svg>
              {{ 'customer.addresses.title' | t }}
            </a>
            
            <a 
              href="{{ routes.account_url }}#orders" 
              class="button button--outline-secondary w-full justify-start"
              x-element-transition-trigger
            >
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="currentColor" d="M13.26 3C8.17 2.86 4 6.95 4 12H2.21c-.45 0-.67.54-.35.85l2.79 2.8c.2.2.51.2.71 0l2.79-2.8a.5.5 0 0 0-.36-.85H6c0-3.9 3.18-7.05 7.1-7c3.72.05 6.85 3.18 6.9 6.9c.05 3.91-3.1 7.1-7 7.1c-1.61 0-3.1-.55-4.28-1.48a.994.994 0 0 0-1.32.08c-.42.42-.39 1.13.08 1.49A8.858 8.858 0 0 0 13 21c5.05 0 9.14-4.17 9-9.26c-.13-4.69-4.05-8.61-8.74-8.74zm-.51 5c-.41 0-.75.34-.75.75v3.68c0 .35.19.68.49.86l3.12 1.85c.36.21.82.09 1.03-.26c.21-.36.09-.82-.26-1.03l-2.88-1.71v-3.4c0-.4-.34-.74-.75-.74z"/></svg>
              {{ 'customer.orders.title' | t }}
            </a>
            
            <hr class="divider my-2">
            
            <a 
              href="{{ routes.account_logout_url }}" 
              class="button button--filled-primary w-full justify-start"
            >
            <svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 1188 1000"><path fill="currentColor" d="m912 236l276 266l-276 264V589H499V413h413V236zM746 748l106 107q-156 146-338 146q-217 0-365.5-143.5T0 499q0-135 68-250T251.5 67.5T502 1q184 0 349 148L746 255Q632 151 503 151q-149 0-251.5 104T149 509q0 140 105.5 241T502 851q131 0 244-103z"/></svg>
              {{ 'customer.log_out' | t }}
            </a>
          </div>
        </div>
      {% else %}
        <div class="flex flex-col gap-3">
          <h2 class="text-lg font-semibold">{{ 'customer.login_page.title' | t }}</h2>
          <p class="text-text-600">{{ 'customer.login_page.subtitle' | t }}</p>
          
          <div class="flex flex-col gap-2">
            <a 
              href="{{ routes.account_login_url }}" 
              class="button button--filled-primary w-full"
              x-element-transition-trigger
            >
              {{ 'customer.login_page.sign_in' | t }}
            </a>
            
            <a 
              href="{{ routes.account_register_url }}" 
              class="button button--outline-secondary w-full"
              x-element-transition-trigger
            >
              {{ 'customer.register.title' | t }}
            </a>
          </div>
        </div>
      {% endif %}
    </div>
  </div>
</div>
