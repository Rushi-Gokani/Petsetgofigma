{% assign minInputName = min_input_name | default: '' %}
{% assign maxInputName = max_input_name | default: '' %}

<div
  class="range-slider relative flex w-full flex-col gap-5 py-4"
  x-data="RangeSlider({{ min }}, {{ max }}, {{ value_min }}, {{ value_max }})"
  x-morph-ignore
  @reset-filters.window="resetValues"
>
  <div class="grid grid-cols-2 gap-5">
    <label for="Filter-{{ minInputName }}" class="range-slider-input">
      <div class="range-slider-input-label ">
        <p>{{ 'products.facets.from' | t }}</p>
      </div>
      <input
        name="{{ minInputName }}"
        id="Filter-{{ minInputName }}"
        class="input__field range-slider-input-field"
        x-model.debounce.300ms="minValue"
        type="number"
        min="{{ min }}"
        max="{{ max }}"
        inputmode="numeric"
        value="{{ value_min }}"
        @blur="onValueChange"
        aria-label="{{ 'products.facets.from' | t }}"
      >
      <div class="range-slider-input-suffix">
        <p>{{ cart.currency.symbol }}</p>
      </div>
    </label>
    <label for="Filter-{{ maxInputName }}" class="range-slider-input">
      <div class="range-slider-input-label ">
        <p>{{ 'products.facets.to' | t }}</p>
      </div>
      <input
        name="{{ maxInputName }}"
        id="Filter-{{ maxInputName }}"
        class="input__field range-slider-input-field"
        x-model.debounce.300ms="maxValue"
        type="number"
        min="{{ min }}"
        max="{{ max }}"
        inputmode="numeric"
        value="{{ value_max }}"
        @blur="onValueChange"
        aria-label="{{ 'products.facets.to' | t }}"
      >
      <div class="range-slider-input-suffix">
        <p>{{ cart.currency.symbol }}</p>
      </div>
    </label>
  </div>
  <div class="relative h-8">
    <div
      tabindex="-1"
      class="relative inline-block h-full w-full cursor-pointer touch-none select-none py-4 outline-0"
      @click="onTrackClick"
    >
      <label for="Range-{{ minInputName }}" class="sr-only tracking-widest">
        {{- 'products.facets.from' | t -}}
      </label>
      <input
        type="range"
        step="1"
        min="{{ min }}"
        max="{{ max }}"
        class="range-slider-hidden-input"
        @input="onMinValueInput"
        @change="onValueChange"
        x-model.debounce.300ms="minValue"
        value="{{ value_min }}"
        aria-label="{{ 'products.facets.from' | t }}"
        id="Range-{{ minInputName }}"
        tabindex="-1"
      >

      <label for="Range-{{ maxInputName }}" class="sr-only tracking-widest">
        {{- 'products.facets.from' | t -}}
      </label>
      <input
        type="range"
        step="1"
        min="{{ min }}"
        max="{{ max }}"
        class="range-slider-hidden-input"
        @input="onMaxValueInput"
        @change="onValueChange"
        x-model.debounce.300ms="maxValue"
        value="{{ value_max }}"
        aria-label="{{ 'products.facets.to' | t }}"
        id="Range-{{ maxInputName }}"
        tabindex="-1"
      >

      <div class="range-slider-track">
        <div
          class="range-slider-track-filled"
          :class="{ 'transitioning': isResetting }"
          :style="
            {
              'inset-inline-start': `${ ((minValue - min) * 100) / (max - min) }%`,
              'inset-inline-end': `${ ((max - maxValue) * 100) / (max - min) }%`
            }
          "
        ></div>
      </div>
    </div>
    <div
      role="slider"
      tabindex="0"
      class="range-slider-thumb range-slider-thumb_left"
      :class="{ 'transitioning': isResetting, 'active': isLeftThumbActive }"
      :style="
        {
          'inset-inline-start': `calc(${((minValue - min) * 100) / (max - min) }% - (32px * ${ ((minValue - min) ) / (max - min)}))`,
        }
      "
      @keydown="handleMinThumbKeydown($event)"
      :aria-valuemin="min"
      :aria-valuemax="max"
      :aria-valuenow="minValue"
      :aria-valuetext="`${minValue}`"
      aria-label="{{- 'products.facets.from' | t -}}"
    ></div>
    <div
      role="slider"
      tabindex="0"
      class="range-slider-thumb range-slider-thumb_right"
      :class="{ 'transitioning': isResetting, 'active': isRightThumbActive }"
      :style="
        {
          'inset-inline-end': `calc(${((max - maxValue) * 100) / (max - min) }% - (32px * ${ ((max - maxValue) ) / (max - min)}))`,
        }
      "
      @keydown="handleMaxThumbKeydown($event)"
      :aria-valuemin="min"
      :aria-valuemax="max"
      :aria-valuenow="maxValue"
      :aria-valuetext="`${maxValue}`"
      aria-label="{{- 'products.facets.to' | t -}}"
    ></div>
  </div>
</div>
