{% comment %}
  Product Marquee (seamless) â€” shows up to 6 items, each item = icon image + text.
  Smooth marquee using two tracks. Accepts settings from the section block.
{% endcomment %}

{% capture marquee_items %}
  {% for i in (1..6) %}
    {% assign icon_key = 'icon_' | append: i %}
    {% assign text_key = 'text_' | append: i %}
    {% assign icon = block.settings[icon_key] %}
    {% assign txt = block.settings[text_key] %}
    {% if txt != blank or icon != blank %}
      <div class="pm-item" style="gap: {{ block.settings.icon_text_gap }}px; padding-right: {{ block.settings.item_gap }}px;">
        {% if icon != blank %}
          {% liquid
            assign base_size = block.settings.icon_size | default: 29
            assign icon_render_size = base_size | times: 1.3 | round: 0
          %}
          <img loading="lazy" src="{{ icon | image_url: width: 96 }}" alt="" width="30px;" height="30px;" style="width: 30px; height: 30px; object-fit: contain;" />
        {% endif %}
        {% if txt != blank %}
          <span class="pm-text">{{ txt }}</span>
        {% endif %}
      </div>
    {% endif %}
  {% endfor %}
{% endcapture %}

<div class="pm-wrapper">
  <div class="pm-viewport"
    style="
      background-color: {{ block.settings.background_color }};
      color: {{ block.settings.text_color }};
      padding: {{ block.settings.padding_vertical }}px {{ block.settings.padding_horizontal }}px;
      border-radius: {{ block.settings.border_radius }}px;
      {% if block.settings.border_top %}border-top: 1px solid {{ block.settings.border_color }};{% endif %}
      {% if block.settings.border_right %}border-right: 1px solid {{ block.settings.border_color }};{% endif %}
      {% if block.settings.border_bottom %}border-bottom: 1px solid {{ block.settings.border_color }};{% endif %}
      {% if block.settings.border_left %}border-left: 1px solid {{ block.settings.border_color }};{% endif %}
    "
  >
    <div class="pm-track" style="animation-duration: {{ block.settings.animation_speed }}s;">
      <div class="pm-segment">{{ marquee_items }}</div>
      <div class="pm-segment" aria-hidden="true">{{ marquee_items }}</div>
    </div>
  </div>
</div>

<style>
  .pm-wrapper {
    width: 100%;
    padding-left: 10px;
    padding-right: 10px;
    box-sizing: border-box;
  }

  .pm-viewport {
    overflow: hidden;
    width: 100%;
    max-height: 40px;
    display: flex;
    align-items: center;
  }
  .pm-track {
    display: flex;
    width: max-content;
    white-space: nowrap;
    align-items: center;
    will-change: transform;
    animation-name: pm-scroll;
    animation-timing-function: linear;
    animation-iteration-count: infinite;
  }
  .pm-segment {
    display: flex;
    align-items: center;
    height: 100%;
  }
  .pm-item {
    display: flex;
    align-items: center;
    height: 100%;
  }
  .pm-text {
    font-size: {{ block.settings.font_size }}px;
    font-weight: {{ block.settings.font_weight }};
    text-transform: {{ block.settings.text_transform }};
    letter-spacing: {{ block.settings.letter_spacing }}px;
    line-height: 1;
  }
  @keyframes pm-scroll {
    0% { transform: translateX(0); }
    100% { transform: translateX(-50%); }
  }
  @media (max-width: 749px) {
    .pm-text {
      font-size: {{ block.settings.mobile_font_size }}px;
    }
    .pm-viewport {
      max-height: 36px;
      display: flex;
      align-items: center;
    }
    .pm-track {
      align-items: center;
    }
    .pm-segment {
      align-items: center;
      height: 100%;
    }
    .pm-item {
      align-items: center;
      height: 100%;
    }
  }
  .pm-viewport:hover .pm-track { animation-play-state: paused; }
</style>
 


