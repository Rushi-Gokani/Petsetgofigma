<div class="{% if section.settings.custom_color_scheme %}color-{{ section.settings.color_scheme }} bg-bg-500{% endif %}">
  <div
    class="{% unless section.settings.full_width %}content-wrapper m-auto{% endunless %}"
    style="padding-top: {{ section.settings.padding_top }}px; padding-bottom: {{ section.settings.padding_bottom }}px;"
    x-init="
      {% comment %} Play the video manually to resolve the frozen video issue in Safari {% endcomment %}
      const playVideo = () => {
        const video = $el.querySelector('video[autoplay=\'autoplay\']');

        if (video && video.currentTime === 0) {
          video.play().catch(() => {});
        }
      };

      document.addEventListener('DOMContentLoaded', () => {
        playVideo();
      });

      $watch('$store.main.isMobile', () => {
        playVideo();
      });
    "
  >
    <div
      class="
        relative
        {% case section.settings.banner_height %}
          {% when 'small' %}h-[40vh]
          {% when 'medium' %}h-[60vh]
          {% when 'large' %}h-[80vh]
          {% when 'full_screen' %}h-screen
        {% endcase %}
        {% unless section.settings.full_width %}rounded-xl overflow-hidden{% endunless %}
      "
    >
      <div
        class="absolute left-0 top-0 z-10 h-full w-full bg-black"
        style="opacity: {{ section.settings.overlay_opacity | divided_by: 100.0 }}"
      ></div>
      <div class="absolute top-0 z-20 flex h-full w-full items-center justify-center bg-gradient-to-b from-[#00000000] to-[#00000040]">
        <div class="max-w-96 text-center text-secondary-500">
          <h1 class="mb-5 text-4xl font-semibold">{{ section.settings.title }}</h1>
          <p class="mb-8">{{ section.settings.description }}</p>
          {% if section.settings.button_label != blank %}
            <a
              {% render '_link-attributes', link: section.settings.button_link %}
            >
              <span class="underline">{{ section.settings.button_label | escape }}</span>
              {% render 'icon-link', class: 'inline' %}
            </a>
          {% endif %}
        </div>
      </div>

      {% liquid
        assign class = 'w-full h-full object-cover'
        unless section.settings.full_width
          assign class = class | append: ' rounded-xl'
        endunless

        assign mobile_video = false
        if section.settings.mobile_video
          assign mobile_video = true
        endif
      %}

      <template x-if="!$store.main.isMobile || !{{ mobile_video }}">
        {{
          section.settings.video
          | video_tag:
            autoplay: section.settings.enable_auto_play,
            loop: section.settings.enable_video_looping,
            controls: false,
            muted: section.settings.mute_video,
            class: class
        }}
      </template>
      <template x-if="$store.main.isMobile && {{ mobile_video }}">
        {{
          section.settings.mobile_video
          | video_tag:
            autoplay: section.settings.enable_auto_play,
            loop: section.settings.enable_video_looping,
            controls: false,
            muted: section.settings.mute_video,
            class: class
        }}
      </template>
    </div>
  </div>
</div>

{% schema %}
{
  "name": "t:sections.video-hero.name",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "default": "Video hero",
      "label": "t:sections.video-hero.settings.title.label"
    },
    {
      "type": "text",
      "id": "description",
      "default": "Give customers details about the video or content on the template.",
      "label": "t:sections.video-hero.settings.description.label"
    },
    {
      "type": "text",
      "id": "button_label",
      "default": "Button label",
      "label": "t:sections.video-hero.settings.button_label.label"
    },
    {
      "type": "url",
      "id": "button_link",
      "label": "t:sections.video-hero.settings.button_link.label"
    },
    {
      "type": "range",
      "id": "overlay_opacity",
      "min": 0,
      "max": 100,
      "step": 10,
      "unit": "%",
      "label": "t:sections.video-hero.settings.overlay_opacity.label",
      "default": 0
    },
    {
      "type": "select",
      "id": "banner_height",
      "options": [
        {
          "value": "small",
          "label": "t:sections.banner.settings.banner_height.options__1.label"
        },
        {
          "value": "medium",
          "label": "t:sections.banner.settings.banner_height.options__2.label"
        },
        {
          "value": "large",
          "label": "t:sections.banner.settings.banner_height.options__3.label"
        },
        {
          "value": "full_screen",
          "label": "t:sections.banner.settings.banner_height.options__4.label"
        }
      ],
      "default": "medium",
      "label": "t:sections.banner.settings.banner_height.label"
    },
    {
      "type": "video",
      "id": "video",
      "label": "t:sections.video-hero.settings.video.label",
      "info": "t:sections.video-hero.settings.video.info"
    },
    {
      "type": "video",
      "id": "mobile_video",
      "label": "t:sections.video-hero.settings.mobile-video.label",
      "info": "t:sections.video-hero.settings.mobile-video.info"
    },
    {
      "type": "checkbox",
      "id": "enable_video_looping",
      "label": "t:sections.video-hero.settings.enable_video_looping.label",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "enable_auto_play",
      "label": "t:sections.video-hero.settings.enable_auto_play.label",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "mute_video",
      "label": "t:sections.video-hero.settings.mute_video.label",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "full_width",
      "label": "t:sections.video-hero.settings.full_width.label",
      "default": true
    },
    {
      "type": "header",
      "content": "t:sections.all.colors.header"
    },
    {
      "type": "checkbox",
      "id": "custom_color_scheme",
      "default": false,
      "label": "t:sections.all.custom_color_scheme.label",
      "info": "t:sections.all.custom_color_scheme.info"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "t:sections.all.colors.label",
      "default": "scheme-1"
    },
    {
      "type": "header",
      "content": "t:sections.all.padding.section_padding_heading"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "t:sections.all.padding.padding_top",
      "default": 36
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "t:sections.all.padding.padding_bottom",
      "default": 36
    }
  ],
  "presets": [
    {
      "name": "t:sections.video-hero.presets.name"
    }
  ]
}
{% endschema %}
