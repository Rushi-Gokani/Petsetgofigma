{% style %}
  #HeroBanner-{{ section.id }} {
    --hero-fallback-bg: {{ section.settings.background_color }};
    --hero-radius: {{ section.settings.border_radius }}px;
    --hero-height-mobile: {{ section.settings.height_mobile }}px;
    --hero-height-desktop: {{ section.settings.height_desktop }}px;
    --hero-button-bg: {{ section.settings.button_color }};
    --hero-button-color: {{ section.settings.button_text_color }};
  }

  #HeroBanner-{{ section.id }} .hero-banner__outer {
    padding-inline: 16px;
  }

  #HeroBanner-{{ section.id }} .hero-banner__card {
    position: relative;
    overflow: hidden;
    border-radius: var(--hero-radius);
    max-width: 1920px;
    margin-inline: auto;
    background: var(--hero-fallback-bg);
    min-height: var(--hero-height-mobile);
  }

  @media (min-width: 768px) {
    #HeroBanner-{{ section.id }} .hero-banner__outer {
      padding-inline: 24px;
    }

    #HeroBanner-{{ section.id }} .hero-banner__card {
      min-height: var(--hero-height-desktop);
    }
  }

  #HeroBanner-{{ section.id }} .hero-banner__media,
  #HeroBanner-{{ section.id }} .hero-banner__media > * {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
  }

  #HeroBanner-{{ section.id }} .hero-banner__media img,
  #HeroBanner-{{ section.id }} .hero-banner__media video {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: center;
  }

  #HeroBanner-{{ section.id }} .hero-banner__content {
    position: relative;
    z-index: 2;
    height: 100%;
    display: flex;
    align-items: flex-end;
    padding: clamp(20px, 4vw, 56px);
  }

  #HeroBanner-{{ section.id }} .hero-banner__text {
    max-width: 640px;
    color: #fff;
    text-shadow: 0 2px 20px rgba(0, 0, 0, 0.35);
  }

  #HeroBanner-{{ section.id }} .hero-banner__heading {
    margin: 0;
    font-weight: 700;
    line-height: 0.95;
    letter-spacing: -0.02em;
    font-size: clamp(2.2rem, 5vw, 4.4rem);
  }

  #HeroBanner-{{ section.id }} .hero-banner__cta {
    margin-top: 18px;
  }

  #HeroBanner-{{ section.id }} .hero-banner__button {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    border-radius: 9999px;
    padding: 12px 28px;
    font-weight: 600;
    font-size: 14px;
    line-height: 1;
    background: var(--hero-button-bg);
    color: var(--hero-button-color);
    text-decoration: none;
    transition: filter 150ms ease;
  }

  #HeroBanner-{{ section.id }} .hero-banner__button:hover {
    filter: brightness(0.95);
  }

  #HeroBanner-{{ section.id }} .hero-banner__controls {
    position: absolute;
    z-index: 3;
    inset-inline-end: 16px;
    inset-block-end: 16px;
    display: flex;
    gap: 10px;
  }

  @media (min-width: 768px) {
    #HeroBanner-{{ section.id }} .hero-banner__controls {
      inset-inline-end: 18px;
      inset-block-end: 18px;
    }
  }

  #HeroBanner-{{ section.id }} .hero-banner__control {
    display: inline-flex;
    height: 42px;
    width: 42px;
    align-items: center;
    justify-content: center;
    border-radius: 9999px;
    background: rgba(0, 0, 0, 0.45);
    backdrop-filter: blur(6px);
    color: #fff;
    border: 0;
    cursor: pointer;
  }

  #HeroBanner-{{ section.id }} .hero-banner__control:focus-visible {
    outline: 2px solid rgba(255, 255, 255, 0.7);
    outline-offset: 2px;
  }
{% endstyle %}

<div
  id="HeroBanner-{{ section.id }}"
  class="hero-banner {% if section.settings.custom_color_scheme %}color-{{ section.settings.color_scheme }} bg-bg-500{% endif %}"
  x-data="{
    isPlaying: {{ section.settings.autoplay_video | json }},
    isMuted: {{ section.settings.mute_video | json }},
    getVideo() {
      return this.$refs.videoContainer ? this.$refs.videoContainer.querySelector('video') : null;
    },
    togglePlay() {
      const video = this.getVideo();
      if (video) {
        if (this.isPlaying) {
          video.pause();
        } else {
          video.play();
        }
        this.isPlaying = !this.isPlaying;
      }
    },
    toggleMute() {
      const video = this.getVideo();
      if (video) {
        video.muted = !this.isMuted;
        this.isMuted = !this.isMuted;
      }
    }
  }"
>
  <div class="hero-banner__outer">
    <div class="hero-banner__card">
      {% comment %} Background Image {% endcomment %}
      <div class="hero-banner__media" aria-hidden="true">
        {% if section.settings.image %}
          {%- assign alt = section.settings.image.alt | default: 'Hero banner image' | t -%}
          {% render 'image',
            img_class: 'max-md:hidden',
            src: section.settings.image,
            width: '100%',
            height: '100%',
            alt: alt
          %}

          {% liquid
            assign alt = section.settings.image.alt | default: 'Hero banner image' | t
            assign mobile_img = section.settings.mobile_image
            unless section.settings.mobile_image
              assign mobile_img = section.settings.image
            endunless
          %}
          {% render 'image',
            img_class: 'md:hidden',
            src: mobile_img,
            width: '100%',
            height: '100%',
            alt: alt
          %}
        {% else %}
          {{ 'image' | placeholder_svg_tag: 'bg-secondary-400' }}
        {% endif %}
      </div>

      {% comment %} Video Background (optional) {% endcomment %}
      {% if section.settings.video %}
        <div
          class="hero-banner__media"
          x-ref="videoContainer"
          x-init="
            $nextTick(() => {
              const video = $refs.videoContainer.querySelector('video');
              if (video) {
                $refs.heroVideo = video;
                video.muted = {{ section.settings.mute_video | json }};
                if ({{ section.settings.autoplay_video | json }}) {
                  video.play().catch(() => {});
                }
              }
            })
          "
          aria-hidden="true"
        >
          {{ section.settings.video | video_tag: controls: false, autoplay: section.settings.autoplay_video, loop: section.settings.loop_video, muted: section.settings.mute_video, playsinline: true }}
        </div>
      {% endif %}

      {% comment %} Content Overlay {% endcomment %}
      <div class="hero-banner__content">
        <div class="hero-banner__text">
          {% comment %} Heading Text {% endcomment %}
          {% if section.settings.heading != blank %}
            <h2 class="heading hero-banner__heading">
              {{ section.settings.heading }}
            </h2>
          {% endif %}

          {% comment %} Shop Now Button {% endcomment %}
          {% if section.settings.button_label != blank %}
            <div class="hero-banner__cta">
              <a
                {% render '_link-attributes', link: section.settings.button_link %}
                class="hero-banner__button"
              >
                {{ section.settings.button_label }}
              </a>
            </div>
          {% endif %}
        </div>
      </div>

      {% comment %} Video Controls (bottom-right) - Always visible {% endcomment %}
      {% if section.settings.video %}
        <div class="hero-banner__controls">
          {% comment %} Play/Pause Button {% endcomment %}
          <button
            @click="togglePlay()"
            class="hero-banner__control"
            aria-label="Play/Pause video"
            type="button"
          >
            <span x-show="!isPlaying" class="h-5 w-5 flex items-center justify-center">
              {% render 'icon-play' %}
            </span>
            <span x-show="isPlaying" class="h-5 w-5 flex items-center justify-center">
              {% render 'icon-pause' %}
            </span>
          </button>

          {% comment %} Volume/Mute Button {% endcomment %}
          <button
            @click="toggleMute()"
            class="hero-banner__control"
            aria-label="Toggle volume"
            type="button"
          >
            <svg
              x-show="isMuted"
              class="h-5 w-5"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
              stroke-width="2"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"
              />
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2"
              />
            </svg>
            <svg
              x-show="!isMuted"
              class="h-5 w-5"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
              stroke-width="2"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"
              />
            </svg>
          </button>
        </div>
      {% endif %}
    </div>
  </div>
</div>

{% schema %}
{
  "name": "Hero Banner",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "header",
      "content": "Content"
    },
    {
      "type": "inline_richtext",
      "id": "heading",
      "default": "Discover our amazing collection",
      "label": "Heading"
    },
    {
      "type": "text",
      "id": "button_label",
      "default": "Shop Now",
      "label": "Button label"
    },
    {
      "type": "url",
      "id": "button_link",
      "label": "Button link"
    },
    {
      "type": "color",
      "id": "button_color",
      "label": "Button color",
      "default": "#FF8C42"
    },
    {
      "type": "color",
      "id": "button_text_color",
      "label": "Button text color",
      "default": "#000000"
    },
    {
      "type": "header",
      "content": "Media"
    },
    {
      "type": "image_picker",
      "id": "image",
      "label": "Image"
    },
    {
      "type": "image_picker",
      "id": "mobile_image",
      "label": "Mobile image",
      "info": "Optional. If not set, desktop image will be used."
    },
    {
      "type": "video",
      "id": "video",
      "label": "Video",
      "info": "Optional. If set, video will play as background instead of image."
    },
    {
      "type": "checkbox",
      "id": "autoplay_video",
      "label": "Autoplay video",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "loop_video",
      "label": "Loop video",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "mute_video",
      "label": "Mute video",
      "default": true
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "range",
      "id": "height_desktop",
      "min": 300,
      "max": 900,
      "step": 10,
      "unit": "px",
      "label": "Height (desktop)",
      "default": 560
    },
    {
      "type": "range",
      "id": "height_mobile",
      "min": 240,
      "max": 700,
      "step": 10,
      "unit": "px",
      "label": "Height (mobile)",
      "default": 420
    },
    {
      "type": "range",
      "id": "border_radius",
      "min": 0,
      "max": 48,
      "step": 2,
      "unit": "px",
      "label": "Border radius",
      "default": 24
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background color",
      "default": "#D2691E",
      "info": "Used as fallback if no image or video is set."
    },
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "checkbox",
      "id": "custom_color_scheme",
      "default": false,
      "label": "Use custom color scheme",
      "info": "Override theme color scheme for this section."
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme",
      "default": "scheme-1"
    }
  ],
  "presets": [
    {
      "name": "Hero Banner"
    }
  ]
}
{% endschema %}
