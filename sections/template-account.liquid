<div
  x-data="{ title: null }"
  class="pb-12 {% if section.settings.custom_color_scheme %}color-{{ section.settings.color_scheme }} bg-bg-500{% endif %}"
>
  <div class="flex items-center justify-between pb-7 pt-4 md:py-8">
    <h1 class="text-lg font-semibold text-text-500">{{ 'customer.account.title' | t }}</h1>
    <a
      href="{{ routes.account_logout_url }}"
      class="md:button md:button--outline md:button--outline-primary max-md:underline"
    >
      {{- 'customer.account.logout' | t -}}
    </a>
  </div>

  <div class="md:grid md:grid-cols-7 md:gap-8">
    <div class="md:col-span-2">
      <span class="px-5 text-text-500">
        {{ 'customer.account.details' | t }}
      </span>

      <div class="contrast-border mb-7 mt-3 rounded-md bg-bg-500 p-5 capitalize">
        <div class="mb-3 flex justify-between">
          <p class="font-semibold text-text-500">
            {{ customer.default_address.name }}
          </p>
          <a x-element-transition-trigger href="{{ routes.account_addresses_url }}" class="link link--primary">
            {{- 'customer.account.view_all' | t -}}
          </a>
        </div>
        <p class="">{{ customer.default_address.address1 }}</p>
        <p class="">{{ customer.default_address.address2 }}</p>
        <p class="">
          {{ customer.default_address.city }}
          {% if customer.default_address.city %}, {% endif %}
          {{ customer.default_address.zip }}
        </p>
        <p class=" text-text-500">{{ customer.default_address.country_name }}</p>
      </div>
    </div>

    <div class="mb-7 md:col-span-5">
      <div class="sm:overflow-hidden">
        {% comment %} Orders {% endcomment %}
        <span class="mb-4 ps-5 text-text-500">
          {{- 'customer.orders.title' | t -}}
        </span>

        {% paginate customer.orders by 20 %}
          {% if customer.orders.size != 0 %}
            <div class="mt-3">
              <div data-content-wrapper>
                <!-- pagination-content -->
                {% for order in customer.orders %}
                  {%- liquid
                    assign popup_id = 'order-popup-' | append: order.id
                  %}

                  <a
                    x-element-transition-trigger.desktop
                    class="contrast-border mb-5 flex flex-col rounded-md border border-transparent bg-bg-500 p-5 font-medium transition-colors duration-200 md:flex-row md:justify-between md:hover:border-primary-600"
                    href="{{ order.customer_url }}"
                    @click="$store.main.isMobile && event.preventDefault(); $store.popup.showPopup('{{ popup_id }}', true);"
                  >
                    <div
                      class="order-cell"
                      data-label="{{ 'customer.orders.order_number' | t }}"
                    >
                      <span class="flex-1">{{- order.name -}}</span>
                    </div>
                    <div
                      class="order-cell"
                      data-label="{{ 'customer.orders.date' | t }}"
                    >
                      <span class="flex-1">{{ order.created_at | time_tag: format: 'date' }}</span>
                    </div>
                    <div
                      class="order-cell"
                      data-label="{{ 'customer.orders.payment_status' | t }}"
                    >
                      <span class="flex-1">{{ order.financial_status_label }}</span>
                    </div>
                    <div
                      class="order-cell"
                      data-label="{{ 'customer.orders.fulfillment_status' | t }}"
                    >
                      <span class="flex-1">{{ order.fulfillment_status_label }}</span>
                    </div>
                    <div
                      class="order-cell md:text-end"
                      data-label="{{ 'customer.orders.total' | t }}"
                    >
                      <span class="flex-1">{{ order.total_price | money_without_trailing_zeros }}</span>
                    </div>
                  </a>

                  {% capture orderPopup %}
                  <div class="contents print:!block">
                    <div class="flex items-center justify-between px-2 md:pt-4">
                      <span class="mb-2 block md:mb-3 md:px-5 md:text-text-500 max-md:font-semibold">
                        {{ 'customer.order.title' | t: name: order.name }}
                      </span>

                      <button
                        class="border-text-text-500 rounded-sm border p-3 md:hidden print:hidden"
                        @click="$store.popup.hidePopup('{{ popup_id }}')"
                        type="button"
                      >
                        {% render 'icon-close' %}
                      </button>
                    </div>

                    {% render 'order-items', order: order %}
                  </div>
                  {% endcapture %}

                  {% render 'popup', content: orderPopup, id: popup_id, isFocused: true %}
                {% endfor %}
                <!-- end-pagination-content -->
              </div>
            </div>
          {% else %}
            <span class="">{{ 'customer.orders.none' | t }}</span>
          {% endif %}

          {%- if paginate.pages > 1 and paginate.next -%}
            <div class="mt-4 flex flex-col items-center">
              <a
                href="#"
                x-pagination-trigger="{ 'lastPage': {{ paginate.pages }} }"
                class="button button--filled button--filled-primary cursor-pointer max-md:w-full"
              >
                {{ 'customer.orders.load_more' | t }}
              </a>
            </div>
          {%- endif -%}
        {% endpaginate %}
      </div>
    </div>
  </div>
</div>

{% schema %}
{
  "name": "t:sections.account-page.name",
  "settings": [
    {
      "type": "header",
      "content": "t:sections.all.colors.header"
    },
    {
      "type": "checkbox",
      "id": "custom_color_scheme",
      "default": false,
      "label": "t:sections.all.custom_color_scheme.label",
      "info": "t:sections.all.custom_color_scheme.info"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "t:sections.all.colors.label",
      "default": "scheme-1"
    }
  ]
}
{% endschema %}
